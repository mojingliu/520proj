<title>JOOS deliverable: peephole patterns</title>
<table border=5 cellspacing=5 cellpadding=5 width=100%>
<tr><td>
<h1><img src="../images/joos32.gif"> deliverable: peephole
patterns</h1> The <img src="../images/a-small.gif"> implementation
only uses 4 peephole patterns.  The generated code is pretty bad when
compared with <code>javac</code>.  There are many more patterns that
can help the optimizer reduce the size of the generated bytecode.<p>

For this deliverable you must repeatedly examine the Jasmin assembly
(<code>.j</code>) files produced by the A- and A+ joos compilers as
well as <code>dejava</code> after disassembling <code>.class</code>
files compiled by <code>javac</code>, identify as many peephole
patterns as you can, and implement them following the templates in
<code><a href="../joos/a-/patterns.h">patterns.h</a></code>.  As you implement
patterns and shrink the generated code, you will find even more
patterns that you can exploit.<p>

You should examine <a href="../joos/a-/optimize.c"><code>
optimize.c</code></a> to see the various primitives you can use in
your patterns.  In particular, a pattern may only use the given
operations on the goto graph and the <code>makeCODExxx</code>
constructors defined in <a href="../joos/a-/tree.h"><code>tree.h</code></a>.
Extensions are of course possible, but they must be clearly documented.
<p>
See the <a href="../howtopeepholeopt.html">instructions</a> for running the benchmarks.
<p>
You should create a new branch of your A- compiler:<p>
<code>$ svn cp group-X/joos/stacklimits group-X/joos/peephole</code><br>
<code>$ svn ci -m "* Create new A- branch for peephole contest"</code>
<p>



You should check in the following:
<ul>

<li>Modifications to your <code>patterns.h</code> file.
<p>
<li>A file called <code> compile.log </code> showing the results of
running the <code>compile_and_run_opt</code> script on
the <a href="../benchmarks/2009/joos/">2009 class set of
benchmarks</a>.  The TAs will make them available shortly, and while
you are waiting, you should just experiment using the benchmarks from
previous years.
<p>
Your log file must show that all benchmarks compile correctly,
verify correctly, and run with the correct output.  This means that
there must be no differences between the expected output and what each
optimized benchmark produces.
<p>
Making sure the patterns operate correctly on your benchmarks is
necessary, but not sufficient.  In addition, we will be manually
checking your patterns are sound in general, removing any unsound
patterns, and rerunning all of the benchmarks if necessary.
<p>
<li>A file called <code>size</code> containing the result of running
the <code>totalbytes</code> command on the .j files produced by
your final A- compiler with your peephole optimizations enabled.  This
size is determined by compiling your .j file into a .class file and
then decompiling that .class file into a .sj file using dejava.
</ul>

<p>
The deadline is 23:59:59 on the Monday of the week in which the
deliverable is due.  It is worth 10% of your grade.
<p>
Since this deliverable is also the basis for the <a
href="../peeprules.html">peephole contest</a>, <b>the deadline is firm</b>,
and we will simply take the latest pre-deadline version out of the
Subversion repository.  Make sure it works!
</td></tr></table>
<p>
<p>
<p>
<table border=5 cellspacing=5 cellpadding=5 width=100%>
<tr><td>
Maintained by Chris Pickett.
<a href="index.html">[HOME]</a>
</td></tr>
</table>
